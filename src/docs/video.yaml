paths:
  /api/videos:
    get:
      summary: 동영상 목록 조회
      description: "최신순으로 동영상 목록을 조회합니다."
      tags: [ Video ]
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
          description: 페이지 번호
        - in: query
          name: limit
          schema:
            type: integer
            default: 20
          description: 가져올 개수
      responses:
        200:
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Video'

    post:
      summary: 동영상 업로드
      description: "비디오 파일과 썸네일을 업로드합니다. (로그인 필요)"
      tags: [ Video ]
      security:
        - bearerAuth: [ ]
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - title
                - video
                - thumbnail
              properties:
                title:
                  type: string
                  description: 영상 제목
                description:
                  type: string
                  description: 영상 설명
                video:
                  type: string
                  format: binary
                  description: 비디오 파일 (mp4 등)
                thumbnail:
                  type: string
                  format: binary
                  description: 썸네일 이미지 (jpg, png)
      responses:
        201:
          description: 업로드 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  video:
                    $ref: '#/components/schemas/Video'
        400:
          description: 파일 누락 또는 잘못된 요청
        401:
          description: 인증 실패

  /api/videos/{id}:
    get:
      summary: 동영상 상세 조회
      description: "동영상 상세 정보를 조회하고 조회수를 1 증가시킵니다."
      tags: [ Video ]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: 동영상 ID
      responses:
        200:
          description: 조회 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Video'
        404:
          description: 영상을 찾을 수 없음
  /api/videos/{id}/like:
    post:
      summary: 동영상 좋아요 토글
      description: "좋아요를 누르거나 취소합니다. (로그인 필요)"
      tags: [ Video ]
      security:
        - bearerAuth: [ ]
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: 동영상 ID
      responses:
        200:
          description: 처리 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  isLiked:
                    type: boolean
                    description: "변경 후 좋아요 상태 (true: 좋아요 됨, false: 취소됨)"
                    example: true
        401:
          description: 인증 실패 (로그인 필요)
        404:
          description: 영상을 찾을 수 없음
  /api/videos/history:
    get:
      summary: 시청 기록 조회
      description: "로그인한 유저가 시청한 동영상 목록을 최신순으로 조회합니다."
      tags: [ Video ]
      security:
        - bearerAuth: [ ]
      responses:
        200:
          description: 조회 성공
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Video'
        401:
          description: 인증 실패

components:
  schemas:
    # --- Video Schema ---
    Video:
      type: object
      properties:
        id:
          type: integer
          example: 10
        title:
          type: string
          example: "개발자의 하루 Vlog"
        description:
          type: string
          nullable: true
          example: "오늘은 코딩을 열심히 했습니다."
        videoPath:
          type: string
          description: "비디오 파일 경로 (URL 또는 로컬 경로)"
          example: "/uploads/videos/video_123.mp4"
        thumbnailPath:
          type: string
          nullable: true
          description: "썸네일 이미지 경로"
          example: "/uploads/thumbnails/thumb_123.jpg"
        views:
          type: integer
          example: 1205
        likeCount:
          type: integer
          example: 55
        isLiked:
          type: boolean
          nullable: true
          description: "현재 로그인한 유저가 좋아요를 눌렀는지 여부 (비로그인 시 false 또는 null)"
          example: true
        isSubscribed:
          type: boolean
          nullable: true
          description: "현재 로그인한 유저가 이 채널을 구독했는지 여부"
          example: false
        subscriberCount:
          type: integer
          description: "작성자(채널)의 총 구독자 수"
          example: 1200
        createdAt:
          type: string
          format: date-time
          example: "2024-12-30T09:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
        author:
          type: object
          properties:
            id:
              type: integer
              example: 1
            nickname:
              type: string
              example: "코딩하는고양이"
            profileImage:
              type: string
              nullable: true
              example: "/uploads/profiles/cat.jpg"
